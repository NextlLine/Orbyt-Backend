generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

datasource db {
  provider = "postgresql"
  url      = env("DB_URL")
}

model User {
  id                 String              @id @default(uuid())
  activatedAt        DateTime?
  name               String              @db.VarChar(64)  
  doc                String              @unique @db.VarChar(14)  
  email              String              @unique @db.VarChar(128)  
  hash               String              
  financeWallets     FinanceWallet[]     
  investmentWallets  InvestmentWallet[]  
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
}

model InvestmentWallet {
  id           String        @id @default(uuid())
  name         String
  currencyId   String
  currency     Currency      @relation(fields: [currencyId], references: [id])
  investments  Investment[]
  userId       String
  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Investment {
  id             String              @id @default(uuid())
  ticker         String
  category       InvestmentCategory
  quantity       Float
  currentPrice   Float
  walletId       String
  wallet         InvestmentWallet    @relation(fields: [walletId], references: [id], onDelete: Cascade)
}

model Currency {
  id       String   @id @default(uuid())
  symbol   String
  code     String   @unique
  wallets  InvestmentWallet[]
  finances FinanceWallet[]
}

model FinanceWallet {
  id             String          @id @default(uuid())
  name           String
  balance        Float
  currencyId     String
  currency       Currency        @relation(fields: [currencyId], references: [id])
  transactions   Transaction[]   
  monthReports   MonthReport[]
  userId         String
  user           User            @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model MonthReport {
  id             String         @id @default(uuid())
  date           DateTime
  monthBalance   Float
  walletId       String
  wallet         FinanceWallet  @relation(fields: [walletId], references: [id], onDelete: Cascade)
}

model Transaction {
  id          String            @id @default(uuid())
  description String
  amount      Float
  date        DateTime
  type        TransactionType
  walletId    String
  wallet      FinanceWallet     @relation(fields: [walletId], references: [id], onDelete: Cascade)
}

enum TransactionType {
  FOOD
  HEALTH
  OTHER
}

enum InvestmentCategory {
  STOCK
  FII
  ETF
  CRYPTO
  FIXED_INCOME
}